<div *ngIf="errorMessage">{{ errorMessage }}</div>

<h2>User Management</h2>

<!-- Display a form for adding new users -->
<form (submit)="createUser()">
  <input type="text" placeholder="Email" [(ngModel)]="newUser.email" name="email" required>
  <input type="password" placeholder="Password" [(ngModel)]="newUser.password" name="password" required>
  <input type="text" placeholder="Username" [(ngModel)]="newUser.username" name="username">
  <input type="number" placeholder="Age" [(ngModel)]="newUser.age" name="age">
  <input type="text" placeholder="Phone Number" [(ngModel)]="newUser.phoneNumber" name="phoneNumber">
  <input type="text" placeholder="Role" [(ngModel)]="newUser.role" name="role" required>
  <input type="checkbox" [(ngModel)]="newUser.subscribed" name="subscribed"> Subscribed
  <input type="text" placeholder="Twitter URI" [ngModel]="newUser.socialMedia?.twitterUri" (ngModelChange)="newUser.socialMedia = { ...(newUser.socialMedia || {}), twitterUri: $event }" name="twitterUri">
  <input type="text" placeholder="Facebook URI" [ngModel]="newUser.socialMedia?.fbUri" (ngModelChange)="newUser.socialMedia = { ...(newUser.socialMedia || {}), fbUri: $event }" name="fbUri">
  <button type="submit">Add User</button>
</form>

<!-- Display a table with user details -->
<table>
  <tr>
    <th>Email</th>
    <th>Password</th>
    <th>Username</th>
    <th>Age</th>
    <th>Phone Number</th>
    <th>Role</th>
    <th>Subscribed</th>
    <th>Twitter URI</th>
    <th>Facebook URI</th>
    <th>Actions</th>
  </tr>
  <tr *ngFor="let user of users">
    <td>{{ user.email }}</td>
    <td>{{ user.password }}</td>
    <td>{{ user.username }}</td>
    <td>{{ user.age }}</td>
    <td>{{ user.phoneNumber }}</td>
    <td>{{ user.role }}</td>
    <td>{{ user.subscribed }}</td>
    <td>{{ user.socialMedia ? user.socialMedia.twitterUri : '' }}</td>
    <td>{{ user.socialMedia ? user.socialMedia.fbUri : '' }}</td>
    <td>
      <button *ngIf="user.id" (click)="deleteUser(user.id)">Delete</button>
      <!-- Check if user.id is defined before displaying the delete button -->
      <button (click)="editUser(user)">Edit</button>
    </td>
  </tr>
</table>

<!-- Display a form for editing users -->
<form *ngIf="isEdit" (submit)="updateUser(editingUser.id)">
  <input type="text" placeholder="Email" [(ngModel)]="editingUser.email" name="email" required>
  <input type="password" placeholder="Password" [(ngModel)]="editingUser.password" name="password" required>
  <input type="text" placeholder="Username" [(ngModel)]="editingUser.username" name="username">
  <input type="number" placeholder="Age" [(ngModel)]="editingUser.age" name="age">
  <input type="text" placeholder="Phone Number" [(ngModel)]="editingUser.phoneNumber" name="phoneNumber">
  <input type="text" placeholder="Role" [(ngModel)]="editingUser.role" name="role" required>
  <input type="checkbox" [(ngModel)]="editingUser.subscribed" name="subscribed"> Subscribed
  <input type="text" placeholder="Twitter URI" [ngModel]="editingUser.socialMedia ? editingUser.socialMedia.twitterUri : ''" (ngModelChange)="editingUser.socialMedia = { ...(editingUser.socialMedia || {}), twitterUri: $event }" name="twitterUri">
  <input type="text" placeholder="Facebook URI" [ngModel]="editingUser.socialMedia ? editingUser.socialMedia.fbUri : ''" (ngModelChange)="editingUser.socialMedia = { ...(editingUser.socialMedia || {}), fbUri: $event }" name="fbUri">
  <button type="submit">Update User</button>
  <button (click)="cancelEdit()">Cancel</button>
</form>
